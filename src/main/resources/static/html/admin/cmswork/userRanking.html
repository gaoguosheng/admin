<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <title></title>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="format-detection" content="telephone=no"/>

    <link rel="stylesheet" href="../../../lib/layui/css/layui.css" media="all"/>
</head>

<body class="layui-layout-body">


        <!-- 内容主体区域 -->
        <div style="padding: 15px;">
            <form class="layui-form" action="">
            <div class="layui-form-item">

                <div class="layui-inline">
                    <label class="layui-form-label">日期范围</label>
                    <div class="layui-input-inline">
                        <input type="text" class="layui-input" id="daterange" name="daterange" placeholder=" - " th:value="${model.datestart==null?'': model.datestart +' - ' +model.dateend}">
                    </div>
                </div>

                <div class="layui-inline">
                    <div class="layui-input-inline">
                        <button class="layui-btn" lay-submit="" lay-filter="search">查询</button>
                    </div>
                </div>
            </div>
            </form>


            <table class="layui-hide" id="cmsWorkTable" lay-filter="cmsWorkTable"></table>

            <script type="text/html" id="rankingTpl">
                <!-- 这里的 checked 的状态只是演示 -->
                <input type="checkbox" name="monday" value="" title="接单王"  {{ d.ROWNUM < 4 ? 'checked' : '' }}  />
            </script>

<script src="../../../lib/jquery/jquery.js" ></script>
<script src="../../../lib/layui/layui.js" charset="utf-8"></script>

<script>
    var params={daterange:document.all.daterange.value};
    var table;
    var form;
    function loadTable(){
        table.render({
            id:'cmswork'
            ,elem: '#cmsWorkTable'
            ,url:'userRanking.do'
            ,where:params
            ,cols: [[
                {field:'ROWNUM', title:'排名',sort: true,width:120}
                ,{field:'TOUSER', title:'用户名',width:120}
                ,{field:'USERNAME', title:'姓名',width:120}
                ,{field:'ORGNAME', title: '组织名称',width:120}
                ,{field:'COUNTER', title:'任务数量', width:120}
                ,{field:'COUNTER', title:'', width:120,templet:"#rankingTpl"}
            ]]
            ,page: false
            ,height: 'full-80'
        });
    }

    /**
     * 初始化
     * */
    function init(){

        layui.use('laydate', function(){
            var laydate = layui.laydate;
            //日期范围
            laydate.render({
                elem: '#daterange'
                ,range: true
            });
        });

        layui.use('table', function(){
                 table = layui.table
                    ,form = layui.form;




            loadTable();//加载表格数据



            $('.btn-action .layui-btn').on('click', function(){
                var type = $(this).data('type');
                active[type] ? active[type].call(this) : '';
            });

            //监听提交
            form.on('submit(search)', function(data){
                /*layer.alert(JSON.stringify(data.field), {
                    title: '最终的提交信息'
                });*/
                params=data.field;

                loadTable();
                return false;
            });

        });
    }

    init();

</script>
</body>

</html>